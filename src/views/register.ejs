<!DOCTYPE html>
<html>
<body>
  <%- include('partials/header') %>

  <%- include('partials/head', { title: 'Perfil de Usuario' }) %>

  <!-- Contenido de la página de registro -->
  <div class="container">
    <div class="row">
      <form action="/users/register" method="POST" id="form1">
        <div class="col-10 col-md-6 A">
          <label for="first_name" class="form-label">Nombres</label>
          <input type="text" class="form-control  <%= locals.errors && (errors.first_name && 'is-invalid') %>" name="first_name" id="first_name" value="<%= locals.old && (old.first_name && old.first_name) %>">
          <p style="color: red;" class="login-grupoA"><%= locals.errors && errors.first_name ? errors.first_name.msg : '' %></p>
        </div>
        <div class="col-10 col-md-6 B">
          <label for="last_name" class="form-label">Apellido</label>
          <input type="text" class="form-control  <%= locals.errors && (errors.last_name && 'is-invalid') %>" name="last_name" id="last_name" value="<%= locals.old && (old.last_name && old.last_name) %>">
          <p style="color: red;" class="login-grupoA"><%= locals.errors && errors.last_name ? errors.last_name.msg : '' %></p>
        </div>
        <div class="col-10 col-md-8 C">
          <label for="email" class="form-label">Email</label>
          <input type="email" class="form-control  <%= locals.errors && (errors.email && 'is-invalid') %>" name="email" id="email1" value="<%= locals.old && (old.email && old.email) %>">
          <p style="color: red;" class="login-grupoA"><%= locals.errors && errors.email ? errors.email.msg : '' %></p>
        </div>

        <div class="col-10 col-md-6 D">
          <label for="password" class="form-label">Contraseña</label>
          <input type="password" class="form-control  <%= locals.errors && (errors.password && 'is-invalid') %>" name="password" id="password1" >
          <p style="color: red;" class="login-grupoB"><%= locals.errors && errors.password ? errors.password.msg : '' %></p>
        </div>
        <div class="col-10 col-md-6 E">
          <label for="password2" class="form-label"> Repita Contraseña</label>
          <input type="password" class="form-control  <%= locals.errors && (errors.password2 && 'is-invalid') %>" name="password2" id="password2">
          <p style="color: red;" class="login-grupoB"><%= locals.errors && errors.password2 ? errors.password2.msg : '' %></p>
        </div>

        <div class="col-10 align-items-start">
          <button class="btn btn-dark" type="submit" >Registrate</button>
        </div>
      </form>
    </div>
  </div>

  <%- include('partials/footer') %>

  <script>

window.addEventListener('load', function(){

var form = document.getElementById('form1');
var firstName = document.getElementById('first_name');
var lastName = document.getElementById('last_name');
var email = document.getElementById('email1');
var password = document.getElementById('password1');
var password2 = document.getElementById('password2');
let firstNameError = document.querySelector('.A p');
let lastNameError = document.querySelector('.B p');
let emailError = document.querySelector('.C p');
let passwordError = document.querySelector('.D p');
let password2Error = document.querySelector('.E p');

firstName.addEventListener('input', validateFirstName);
lastName.addEventListener('input', validateLastName);
email.addEventListener('input', validateEmail);
password.addEventListener('input', validatePassword);
password2.addEventListener('input', validatePassword2);

form.addEventListener('submit', function(event) {
    event.preventDefault();
    if (validateFirstName() && validateLastName() && validateEmail() && validatePassword() && validatePassword2()) {
        // Aquí puedes agregar la validación de la contraseña con la base de datos
        // ...
    }
});

function validateFirstName() {
    if(firstName.value === '') {
        firstNameError.textContent = 'El campo nombre es obligatorio';
        return false;
    } else if(!isAlpha(firstName.value)) {
        firstNameError.textContent = 'Solo se permiten caracteres alfabéticos';
        return false;
    } else {
        firstNameError.textContent = '';
        return true;
    }
}

function validateLastName() {
    if(lastName.value === '') {
        lastNameError.textContent = 'El campo apellido es obligatorio';
        return false;
    } else if(!isAlpha(lastName.value)) {
        lastNameError.textContent = 'Solo se permiten caracteres alfabéticos';
        return false;
    } else {
        lastNameError.textContent = '';
        return true;
    }
}

function validateEmail() {
    if(email.value === '') {
        emailError.textContent = 'El email es obligatorio';
        return false;
    } else if(!isEmailValid(email.value)) {
        emailError.textContent = 'El formato es inválido';
        return false;
    } else {
        emailError.textContent = '';
        return true;
    }
}

function validatePassword() {
    if(password.value === '') {
        passwordError.textContent = 'La contraseña es requerida';
        return false;
    } else if(password.value.length < 6 || password.value.length > 12) {
        passwordError.textContent = 'Debe tener entre 6 y 12 caracteres';
        return false;
    } else {
        passwordError.textContent = '';
        return true;
    }
}

function validatePassword2() {
    if(password2.value !== password.value) {
        password2Error.textContent = 'Las contraseñas no coinciden';
        return false;
    } else {
        password2Error.textContent = '';
        return true;
    }
}

function isAlpha(str) {
    let re = /^[a-zA-Z]+$/;
    return re.test(String(str));
}

function isEmailValid(email) {
    let re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
}
})

</script>


  

</body>
</html>
